Index: include/wx/msw/uxthemep.h
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/include/wx/msw/uxthemep.h,v
retrieving revision 1.2
retrieving revision 1.3
diff -u -2 -r1.2 -r1.3
--- include/wx/msw/uxthemep.h	2005/05/14 16:57:49     1.2
+++ include/wx/msw/uxthemep.h	2005/06/08 21:47:29     1.3
@@ -13,5 +13,5 @@
 #define __WINE_UXTHEME_H

-#include <commctrl.h>
+#include "wx/msw/wrapcctl.h"

 typedef HANDLE HTHEME;
Index: src/msw/tbar95.cpp
===================================================================
RCS file: /pack/cvsroots/wxwidgets/wxWidgets/src/msw/tbar95.cpp,v
retrieving revision 1.154
retrieving revision 1.155
diff -u -2 -r1.154 -r1.155
--- src/msw/tbar95.cpp	2005/06/07 19:16:15     1.154
+++ src/msw/tbar95.cpp	2005/06/08 21:28:29     1.155
@@ -1247,6 +1247,7 @@
     }

-    // if comctl32 version < 4.71 wxToolBar95 adds dummy spacers
-#if defined(_WIN32_IE) && (_WIN32_IE >= 0x400 )
+    // when TB_SETBUTTONINFO is available (both during compile- and run-time),
+    // we don't use the dummy separators hack
+#ifdef TB_SETBUTTONINFO
     if ( wxApp::GetComCtl32Version() >= 471 )
     {
@@ -1254,5 +1255,5 @@
     }
     else
-#endif
+#endif // TB_SETBUTTONINFO
     {
         return GetItemSkippingDummySpacers( m_tools, (size_t) index );
